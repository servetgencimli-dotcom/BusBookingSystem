<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.geometry.Insets?>
<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>
<?import javafx.scene.text.Font?>
<?import javafx.scene.chart.*?>

<BorderPane xmlns="http://javafx.com/javafx/17"
            xmlns:fx="http://javafx.com/fxml/1"
            fx:controller="controller.AnalyticsDashboardController"
            style="-fx-background-color: linear-gradient(to bottom, #0f172a, #1e293b);">

    <!-- ÃœST: BaÅŸlÄ±q -->
    <top>
        <VBox spacing="20" style="-fx-background-color: rgba(255,255,255,0.05); -fx-padding: 25;">
            <HBox alignment="CENTER" spacing="15">
                <Label text="ðŸ“Š" style="-fx-font-size: 36px;"/>
                <Label text="Analytics Dashboard"
                       style="-fx-font-size: 32px; -fx-font-weight: bold; -fx-text-fill: white;"/>
            </HBox>

            <!-- Æsas Statistika KartlarÄ± -->
            <HBox spacing="20" alignment="CENTER">
                <VBox alignment="CENTER" spacing="8"
                      style="-fx-background-color: rgba(34,197,94,0.15); -fx-padding: 20; -fx-background-radius: 12; -fx-min-width: 180;">
                    <Label text="ðŸ’° ÃœMUMI GÆLÄ°R" style="-fx-text-fill: #22C55E; -fx-font-size: 11px; -fx-font-weight: bold;"/>
                    <Label fx:id="totalRevenueLabel" text="0.00 AZN"
                           style="-fx-text-fill: white; -fx-font-size: 28px; -fx-font-weight: bold;"/>
                </VBox>

                <VBox alignment="CENTER" spacing="8"
                      style="-fx-background-color: rgba(59,130,246,0.15); -fx-padding: 20; -fx-background-radius: 12; -fx-min-width: 180;">
                    <Label text="ðŸŽ« REZERVASIYALAR" style="-fx-text-fill: #3B82F6; -fx-font-size: 11px; -fx-font-weight: bold;"/>
                    <Label fx:id="totalBookingsLabel" text="0"
                           style="-fx-text-fill: white; -fx-font-size: 28px; -fx-font-weight: bold;"/>
                </VBox>

                <VBox alignment="CENTER" spacing="8"
                      style="-fx-background-color: rgba(168,85,247,0.15); -fx-padding: 20; -fx-background-radius: 12; -fx-min-width: 180;">
                    <Label text="ðŸ‘¥ Ä°STÄ°FADÆÃ‡Ä°LÆR" style="-fx-text-fill: #A855F7; -fx-font-size: 11px; -fx-font-weight: bold;"/>
                    <Label fx:id="totalUsersLabel" text="0"
                           style="-fx-text-fill: white; -fx-font-size: 28px; -fx-font-weight: bold;"/>
                </VBox>

                <VBox alignment="CENTER" spacing="8"
                      style="-fx-background-color: rgba(251,146,60,0.15); -fx-padding: 20; -fx-background-radius: 12; -fx-min-width: 180;">
                    <Label text="â­ ORTA REYTÄ°NQ" style="-fx-text-fill: #FB923C; -fx-font-size: 11px; -fx-font-weight: bold;"/>
                    <Label fx:id="avgRatingLabel" text="0.0 â­"
                           style="-fx-text-fill: white; -fx-font-size: 28px; -fx-font-weight: bold;"/>
                </VBox>
            </HBox>
        </VBox>
    </top>

    <!-- MÆRKÆZ: QrafiklÉ™r vÉ™ CÉ™dvÉ™llÉ™r -->
    <center>
        <VBox spacing="20" style="-fx-padding: 20;">
            <!-- QrafiklÉ™r SÉ™tri -->
            <HBox spacing="20" VBox.vgrow="ALWAYS">
                <!-- Sol tÉ™rÉ™f: MarÅŸrut StatistikasÄ± -->
                <VBox spacing="10" HBox.hgrow="ALWAYS"
                      style="-fx-background-color: rgba(255,255,255,0.08); -fx-padding: 15; -fx-background-radius: 12;">
                    <Label text="ðŸšŒ Top 5 MarÅŸrut"
                           style="-fx-text-fill: white; -fx-font-size: 18px; -fx-font-weight: bold;"/>
                    <BarChart fx:id="routeChart" VBox.vgrow="ALWAYS"
                              style="-fx-background-color: transparent;">
                        <xAxis>
                            <CategoryAxis side="BOTTOM" label="MarÅŸrutlar"
                                          style="-fx-tick-label-fill: white;"/>
                        </xAxis>
                        <yAxis>
                            <NumberAxis side="LEFT" label="Rezervasiya SayÄ±"
                                        style="-fx-tick-label-fill: white;"/>
                        </yAxis>
                    </BarChart>
                </VBox>

                <!-- SaÄŸ tÉ™rÉ™f: GÉ™lir Qrafiki -->
                <VBox spacing="10" HBox.hgrow="ALWAYS"
                      style="-fx-background-color: rgba(255,255,255,0.08); -fx-padding: 15; -fx-background-radius: 12;">
                    <Label text="ðŸ“ˆ AylÄ±q GÉ™lir Trendi"
                           style="-fx-text-fill: white; -fx-font-size: 18px; -fx-font-weight: bold;"/>
                    <LineChart fx:id="revenueChart" VBox.vgrow="ALWAYS"
                               style="-fx-background-color: transparent;">
                        <xAxis>
                            <CategoryAxis side="BOTTOM" label="Ay"
                                          style="-fx-tick-label-fill: white;"/>
                        </xAxis>
                        <yAxis>
                            <NumberAxis side="LEFT" label="GÉ™lir (AZN)"
                                        style="-fx-tick-label-fill: white;"/>
                        </yAxis>
                    </LineChart>
                </VBox>
            </HBox>

            <!-- Alt SÉ™tir: CÉ™dvÉ™llÉ™r -->
            <HBox spacing="20" prefHeight="250">
                <!-- Son Rezervasiyalar -->
                <VBox spacing="10" HBox.hgrow="ALWAYS"
                      style="-fx-background-color: rgba(255,255,255,0.08); -fx-padding: 15; -fx-background-radius: 12;">
                    <Label text="ðŸ•’ Son Rezervasiyalar"
                           style="-fx-text-fill: white; -fx-font-size: 16px; -fx-font-weight: bold;"/>
                    <TableView fx:id="recentBookingsTable" VBox.vgrow="ALWAYS"
                               style="-fx-background-color: transparent;">
                        <columns>
                            <TableColumn fx:id="bookingUserCol" text="SÉ™rniÅŸin" prefWidth="120"/>
                            <TableColumn fx:id="bookingRouteCol" text="MarÅŸrut" prefWidth="150"/>
                            <TableColumn fx:id="bookingPriceCol" text="QiymÉ™t" prefWidth="80"/>
                        </columns>
                    </TableView>
                </VBox>

                <!-- Top Ä°stifadÉ™Ã§ilÉ™r -->
                <VBox spacing="10" HBox.hgrow="ALWAYS"
                      style="-fx-background-color: rgba(255,255,255,0.08); -fx-padding: 15; -fx-background-radius: 12;">
                    <Label text="ðŸ† Top Ä°stifadÉ™Ã§ilÉ™r"
                           style="-fx-text-fill: white; -fx-font-size: 16px; -fx-font-weight: bold;"/>
                    <TableView fx:id="topUsersTable" VBox.vgrow="ALWAYS"
                               style="-fx-background-color: transparent;">
                        <columns>
                            <TableColumn fx:id="userNameCol" text="Ad" prefWidth="120"/>
                            <TableColumn fx:id="userBookingsCol" text="SÉ™fÉ™rlÉ™r" prefWidth="80"/>
                            <TableColumn fx:id="userSpentCol" text="XÉ™rc (AZN)" prefWidth="100"/>
                        </columns>
                    </TableView>
                </VBox>
            </HBox>
        </VBox>
    </center>

    <!-- ALT: DÃ¼ymÉ™lÉ™r -->
    <bottom>
        <HBox spacing="15" alignment="CENTER" style="-fx-background-color: rgba(255,255,255,0.05); -fx-padding: 20;">
            <Button text="ðŸ”„ YenilÉ™" onAction="#handleRefresh"
                    style="-fx-background-color: #22C55E; -fx-text-fill: white; -fx-font-size: 14px; -fx-padding: 12 25; -fx-background-radius: 8;">
                <font><Font name="System Bold" size="14"/></font>
            </Button>

            <Button text="ðŸ“¥ Export Excel" onAction="#handleExport"
                    style="-fx-background-color: #3B82F6; -fx-text-fill: white; -fx-font-size: 14px; -fx-padding: 12 25; -fx-background-radius: 8;">
                <font><Font name="System Bold" size="14"/></font>
            </Button>

            <Button text="â¬… Geri" onAction="#handleBack"
                    style="-fx-background-color: #EF4444; -fx-text-fill: white; -fx-font-size: 14px; -fx-padding: 12 25; -fx-background-radius: 8;">
                <font><Font name="System Bold" size="14"/></font>
            </Button>
        </HBox>
    </bottom>

</BorderPane>